---
title: "hw5"
output: github_document
date: "2025-11-11"
---

```{r setup, include=FALSE}
library(tidyverse)
library(rvest)
library(broom)
set.seed(1)

```


## Problem1

```{r}
# Function to simulate whether at least two people share a birthday
same_birthday <- function(n) {
  
  birthdays <- sample(1:365, size = n, replace = TRUE)
  
  has_duplicate <- any(duplicated(birthdays))
  
  # Step 3: Return TRUE if there is a shared birthday, FALSE otherwise
  return(has_duplicate)
}


set.seed(123)
n_sim <- 10000
group_sizes <- 2:50
prob_results <- numeric(length(group_sizes))

prob_results <- sapply(group_sizes, function(n) {
  mean(replicate(n_sim, same_birthday(n)))   # Average of TRUE/FALSE results
})


birthday_df <- data.frame(
  group_size = group_sizes,
  probability = prob_results
)

library(ggplot2)
ggplot(birthday_df, aes(x = group_size, y = probability)) +
  geom_line(color = "steelblue", size = 1.3) +
  geom_point(color = "darkred", size = 2) +
  labs(
    title = "Probability That at Least Two People Share a Birthday",
    subtitle = "10,000 simulations per group size (no leap years)",
    x = "Group Size (n)",
    y = "Probability"
  ) +
  theme_minimal(base_size = 14)
```

## Problem 2
```{r}
n <- 30
sigma <- 5
mu <- 0
n_sim <- 5000

sim_results <- expand_grid(
  mu = mu,
  iter = 1:n_sim
) |>
  mutate(
    data = map(mu, ~ rnorm(n, mean = .x, sd = sigma)),
    test = map(data, ~ t.test(.x, mu = 0)),
    tidy = map(test, tidy),
    mu_hat = map_dbl(tidy, "estimate"),
    p_value = map_dbl(tidy, "p.value"),
    reject = p_value < 0.05
  )

```





